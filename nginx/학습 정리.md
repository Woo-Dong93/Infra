# nginx란?

- 트래픽이 많은 웹사이트를 위해 확정성을 위해 설계한 비동기 이벤트 기반구조의 **웹서버 소프트웨어** 입니다.
- 예전에는 Apache를 많이 사용하였지만 지금은 nginx를 더 많이 사용하고 있습니다.
- C로 짜여져 있고 성능이 매우 우수하다고 합니다.
  - 순간 커넥션이 1만정도 들어와도 버틸 수 있습니다.



### 1. Apache vs nginx

- Aparche
  - 쓰레드 / 프로세스 기반 구조로 요청 하나당 쓰레드 하나가 처리하는 구조입니다.
  - 사용자가 많아지면 많은 쓰레드를 생성 => 메모리 및 CPU 낭비가 심해집니다.
- nginx
  - 비동기 Event-Driven 기반 구조
  - 다수의 연결을 효과적으로 처리 가능합니다.
  - 더 작은 쓰레드로 클라이언트의 요청을 처리할 수 있습니다.



### 2. Event-Driven

- 여러가지 이벤트들이 호출되었을 때 Event Handler에 다 몰아 넣습니다.
- Event-Driven을 통해 Event가 비동기적으로 완료되는 시점마다 Core에 전달합니다.
  - node.js 같은 경우 이벤트 루프를 통해 이벤트가 완료되면 호출 스택에 올라갑니다.



### 3. 활용

- node.js server 같은 경 **버퍼 오버플로우**에 취약하다는 단점이 있습니다.
  - 버퍼 오버플로우 : 버퍼는 보통 데이터가 저장되는 메모리 공간을 의미, 만약 메모리 공간을 벗어나는ㄴ 경우 오버플로우가 되고 이 때 사용되지 않아야 할 영역에 데이터가 덮어씌워져 주소나 값이 변경되는 현상
- 앞단에다가 프록시 서버로 nginx를 활용하게 되면 보안할 수 있습니다.
  - 보통 실제 포트를 숨기고 nginx를 80포트로 설정 ( 보안적으러 막을 수 있다. )
  - 앞단에서 **로그**를 저장할 수 있다.
- 실제 naver에서는 과거에 ( 2013년도 컨퍼런스 ) 서버대수 1/3 감소, 장애 0건으로 엄청난 이득을 보았다고 보고되었습니다.
- 보통 Node, Spring 등의 서버에서 바로 직빵으로 트래픽을 때리면 OOM(OutOfMemory) 현상이나 알수 없는 서버오류로 서버가 죽어버리는 현상이 자주 발생합니다.
- 그래서 앞단에 nginx를 두어 부하분산, 로드벨런싱 등을 임시로 처리해줍니다.
- 또한 쓸데없는 경로로 찔러보는 디도스 공격을 스루패스 해서 버릴 수 있습니다.
  - 서버가 어떤 포트를 쓰고 어떠한 서버(php, java, node)로 되어있는지 감출 수 있다.
- 캐시 기능도 존재합니다.





